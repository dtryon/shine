<!DOCTYPE html>
<html>
<head>
	<title>shine</title>
	<script src="/components/react/react.js"></script>
	<script src="/components/react/JSXTransformer.js"></script>
	<script type="text/jsx" src="/views/file-uploader/file-uploader.js"></script>
	<script>
		window.onload = function() {

			var clickX = new Array();
			var clickY = new Array();
			var clickDrag = new Array();
			var originX = 0;
			var originY = 0;
			var paint;
			var canvas = document.getElementById('canvas');
			context = canvas.getContext('2d');

			function addClick(x, y, dragging) {
				clickX.push(x);
				clickY.push(y);
				clickDrag.push(dragging);
			}

			function redraw(x, y){
				context.clearRect(0, 0, context.canvas.width, context.canvas.height); // Clears the canvas

				context.strokeStyle = "#000000";
				context.lineWidth = 2;
					
				// for(var i=0; i < clickX.length; i++) {		
				// 	context.beginPath();
				// 	if(clickDrag[i] && i) {
				// 		//context.moveTo(clickX[i-1], clickY[i-1]);
				// 		context.moveTo(originX, originY);
				// 	// } else {
				// 	// 	context.moveTo(clickX[i]-1, clickY[i]);
				// 	// }
				// 		context.lineTo(originX, clickY[i]);
				// 		context.closePath();
				// 		context.stroke();
				// 		context.lineTo(clickX[i], originY);
				// 		context.closePath();
				// 		context.stroke();
				// 	}
				// }

				if (x && y) {

					context.beginPath();
					context.moveTo(originX, originY);
					context.lineTo(originX, y);
					context.closePath();
					context.stroke();
					context.lineTo(x, originY);
					context.closePath();
					context.stroke();


					context.beginPath();
					context.moveTo(x, y);
					context.lineTo(originX, y);
					context.closePath();
					context.stroke();
					context.lineTo(x, originY);
					context.closePath();
					context.stroke();
				}


			}

			canvas.addEventListener('mousedown', function(e){

				clickX.length = 0;
				clickY.length = 0;
				clickDrag.length = 0;

				var mouseX = originX = e.pageX - this.offsetLeft;
				var mouseY = originY = e.pageY - this.offsetTop;
							 						
				paint = true;
				addClick(mouseX, mouseY);
				redraw();
			});

			canvas.addEventListener('mousemove', function(e) {
				if(paint) {
					var mouseX = e.pageX - this.offsetLeft;
					var mouseY = e.pageY - this.offsetTop;
					addClick(mouseX, mouseY, true);
					redraw(mouseX, mouseY);
				}
			});

			canvas.addEventListener('mouseup', function(e) {
				paint = false;
			});

			canvas.addEventListener('mouseleave', function(e) {
				paint = false;
			});


		};
	</script>
	<style>
		#canvas {
			border-style: solid;
    		border-width: 5px;
		}
	</style>
</head>
<body>
	<div>
		<h1>Image Uploader Test:</h1>
	</div>
	<div id="file-uploader"></div>
	<canvas id="canvas" width="490" border="1" height="220"></canvas>
</body>
</html>